---
title: "p8105_hw3_kg3006"
author: "Kevin Guzman"
date: "2025-10-09"
output: github_document
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(broom)
```


## Problem 1 

The graph below demonstrates the probability that there is at least 1 shared birthday in a group of individuals from a group of 2 people to 50 simulated over 10,000 trials. 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Writting bithrday loop function
birthday <- function(x) {
  birthday <- sample(1:365, size=x, replace=TRUE)
  
  #check duplicates 
  any(duplicated(birthday))
}

#Defining varibles 
set.seed(123)
group_sizes <- 2:50
n <- 10000

#Simulating birthday problem
results <- sapply(group_sizes, function(x) {
  mean(replicate(n, birthday(x)))
})

#Plot 
plot(group_sizes, results, type = "b",
     xlab = "Group size (n)",
     ylab = "Probability of shared birthday",
     main = "Probability of Shared Birthday by Group Size")
```

As noted in the graph. As the group sizes increase, the probabiliyt of a shared birthday also increases. Interestingly, even though there are 365 possible birthdays. The probability of a shared birthday among a group of 25 people is already over 50% and that of a group of 50 people is nearly 100%! 


## Problem 2 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Setting fixed design element n = 30, and sigma=5, muu=0
set.seed(123)
n <- 30
sigma <- 5
muu <- 0
nsim <- 5000

#Creating a function that is easier 
mean_p <- function(muu, n, sigma, nsim) {
  sim_data <- replicate(nsim, {
    x <- rnorm(n, mean = muu, sd = sigma)
    ttest <- t.test(x, mu = 0)
    #Saving in table
    tibble(
      mean = mean(x),
      p_value = ttest$p.value,
      muu = muu)
    }, simplify = FALSE) %>% 
    bind_rows()
}

# Run the simulation 
sim_data <- mean_p(muu, n, sigma, nsim)
```

